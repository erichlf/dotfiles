# automatically run `zgen reset` if we modify our .zshrc
ZGEN_RESET_ON_CHANGE=("${HOME}/.zshrc")

# load zgen
source "${HOME}/.zgen/zgen.zsh"

zgen selfupdate

# if the init scipt doesn't exist
if ! zgen saved; then
    zgen oh-my-zsh

    # plugins
    zgen oh-my-zsh plugins/1password
    zgen oh-my-zsh plugins/colored-man-pages
    zgen oh-my-zsh plugins/colorize
    zgen oh-my-zsh plugins/command-not-found
    zgen oh-my-zsh plugins/common-aliases
    zgen oh-my-zsh plugins/copyfile
    zgen oh-my-zsh plugins/copypath
    zgen oh-my-zsh plugins/cp
    zgen oh-my-zsh plugins/dirhistory
    zgen oh-my-zsh plugins/docker
    zgen oh-my-zsh plugins/docker-compose
    zgen oh-my-zsh plugins/emacs
    zgen oh-my-zsh plugins/fzf
    zgen oh-my-zsh plugins/git
    zgen oh-my-zsh plugins/git
    zgen oh-my-zsh plugins/man
    zgen oh-my-zsh plugins/pass
    zgen oh-my-zsh plugins/rsync
    zgen oh-my-zsh plugins/safe-paste
    zgen oh-my-zsh plugins/sudo
    zgen oh-my-zsh plugins/sudo
    zgen oh-my-zsh plugins/ubuntu
    zgen oh-my-zsh plugins/web-search
    zgen oh-my-zsh plugins/zsh-interactive-cd

    zgen load zsh-users/zsh-autosuggestions
    zgen load zsh-users/zsh-history-substring-search
    zgen load zsh-users/zsh-syntax-highlighting

    # theme
    # zgen oh-my-zsh themes/arrow

    # save all to init script
    zgen save
fi

# automatically upgrade oh-my-zsh without asking
DISABLE_UPDATE_PROMPT=true
zstyle ':omz:update' mode auto      # update automatically without asking

# enable command auto-correction.
ENABLE_CORRECTION="true"

# display red dots whilst waiting for completion.
COMPLETION_WAITING_DOTS="true"

extensions=(
  1password.plugin.zsh
  zmv
  zcp
  zln
)

for extension in $extensions; do
  autoload -U $extension;
done

# no point in rewriting my aliases
[ -f ~/.exports ] && source ~/.exports
[ -f ~/.aliases ] && source ~/.aliases

eval "$(zoxide init --cmd cd zsh)"

setopt nonomatch

eval "$(starship init zsh)"

# Add RVM to PATH for scripting. Make sure this is the last PATH variable change.
export PATH="$PATH:$HOME/.rvm/bin"
